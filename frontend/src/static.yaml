schema: >
  directive @auth(rules: [AuthRule!]!) on OBJECT

  
  input AuthRule {
    role: Role
    possession: Possession!
    attributes: [String!]!
  }

  
  enum Role {
    ADMIN
    CUSTOMER
    VISITOR
  }
  
  
  enum Possession {
    OWN
    ANY
  }

  
  type Book
    @auth(
      rules: [
        { role: ADMIN, possession: ANY, attributes: ["*"] }
        { role: VISITOR, possession: ANY, attributes: ["title", "author"] }
        { role: CUSTOMER, possession: ANY, attributes: ["price"] }
        { role: CUSTOMER, possession: OWN, attributes: ["*"] }
      ]
    ) {
    title: String
    author: String
    owner: String
    price: String
  }

  
  type User {
    loggedIn: Boolean
    roles: [String!]
    email: String
    subject: String
  }

  
  type Query {
    books: [Book]
    me: User
  }